#lang at-exp racket/base

(require ming ming/list ming/string ming/number net/uri-codec
         racket/format
         "gua-helper.rkt"
         "8gua.rkt"
         "64gua.rkt"
         "senders.rkt"
         "zixuan.rkt")
(provide å¤©ä»·åœ°é‡? å¤©é‡åœ°ä»·? é«˜ä»·ç¼©é‡? ä½ä»·èµ·é‡? ä½ä»·ä½é‡? è¶…é‡è¶…ä»·?
         get-days å¦è±¡è§£æ é‡ä»·è§£æ æ¦‚è§ˆ é£é™© é¢„è­¦)

;; (å (ä»Šæ—¥ä¹°å–ç‚¹ data)
;;     (å data0 (ô¾› data))
;;     (å d0 (ô·œ data))
;;     (å d1 (ô·› data))
;;     (å d2 (ô·š data))
;;     (å datan3 (d0 d1 d2))
;;     )

;; (å (æŒç»­è·ƒè¿? d0 d1 d2)
;;     (å n1
;;         (ô·‘ôº— (å…¥ (d) (ô¿°å¼” 'jgua-n d)) (ô¿´ d0 d1 d2)))
;;     (å n2
;;         (ô·‘ôº˜ (å…¥ (d) (ô¿°å¼” 'jgua-n d)) (ô¿´ d0 d1 d2)))
;;     (ä¸« (> (- n1 n2) 1)
;;         #t
;;         #f)
;;     )

;; (å (å½“æ—¥æ´»è·ƒ? d0 d1 d2)
;;     (if (> (ô¿°å¼” d0 'lgua-n) 4)
;;         #t
;;         #f))

;; (å (ä¹°å…¥? d0 d1 d2)
;;     (if (< (ô¿°å¼” d0 'jgua-n) 3)
;;         #t
;;         #f))

;; (å (å–å‡º? d0 d1 d2)
;;     (if (> (ô¿°å¼” d0 'jgua-n) 5)
;;         #t
;;         #f))

(å (è¶…é‡è¶…ä»·? d)
    (å¹¶ (> (ô¿°å¼” d 'jgua-n) 5)
        (> (ô¿°å¼” d 'lgua-n) 5)))

(å (å¤©ä»·åœ°é‡? d)
    (å¹¶ (> (ô¿°å¼” d 'jgua-n) 5)
        (< (ô¿°å¼” d 'lgua-n) 2)))

(å (å¤©é‡åœ°ä»·? d)
    (å¹¶ (< (ô¿°å¼” d 'jgua-n) 2)
        (> (ô¿°å¼” d 'lgua-n) 5)))

(å (é«˜ä»·ç¼©é‡? d)
    (å¹¶ (> (ô¿°å¼” d 'jgua-n) 5)
        (å¹¶ (> (ô¿°å¼” d 'lgua-n) 2)
            (< (ô¿°å¼” d 'lgua-n) 5))))

(å (ä½ä»·èµ·é‡? d)
    (å¹¶ (< (ô¿°å¼” d 'jgua-n) 3)
        (å¹¶ (> (ô¿°å¼” d 'lgua-n) 5)
            (< (ô¿°å¼” d 'lgua-n) 8))))

(å (ä½ä»·ä½é‡? d)
    (å¹¶ (< (ô¿°å¼” d 'jgua-n) 2)
        (< (ô¿°å¼” d 'lgua-n) 2)))

(å (ä¹°å…¥ä¿¡å·? dn) ; è¿ç»­ä¸‰æ—¥ä½ä»·èµ·é‡
    (ô· ä½ä»·èµ·é‡? dn))

(å (å–å‡ºä¿¡å·? dn) ; è¿ç»­ä¸‰æ—¥é«˜ä»·ç¼©é‡
    (ô· é«˜ä»·ç¼©é‡? dn))

(å (è¶…ä¹°ä¿¡å·? d)
    (å¤©é‡åœ°ä»·? d))

(å (é£é™©ä¿¡å·? d)
    (å¤©ä»·åœ°é‡? d))

(å (get-days proced dn)
    (ô·‘  (lambda (d) (ô¿°å¼” d 'day))
        (ô¹ˆ proced dn)))

(å (å¦è±¡è§£æ å¤å¦)
    (ä»¤ ([ä¸Šå¦ (ä¹‹ä¸Šå•å¦ å¤å¦)]
         [ä¸‹å¦ (ä¹‹ä¸‹å•å¦ å¤å¦)])
        @~a{@|å¤å¦| / @(åŒ–å¦ç¬¦/64 å¤å¦) / @(åŒ–å¦æ•°/64 å¤å¦)ï¼Œé‡ï¼š@|ä¸Šå¦| / @(åŒ–å¦ç¬¦/8 ä¸Šå¦) / @(åŒ–å¦æ•°/8 ä¸Šå¦)ï¼› ä»·ï¼š@|ä¸‹å¦| / @(åŒ–å¦ç¬¦/8 ä¸‹å¦) / @(åŒ–å¦æ•°/8 ä¸‹å¦)ã€‚}))

(å (é‡ä»·è§£æ d)
    (å (ç½® data key)
        (è‚– (ô¿°å¼” data key)
            [(5 6 7) "é«˜"]
            [(3 4) "ä¸­"]
            [(0 1 2) "ä½"]
            [å¤¬ #f]))
    @~a{äº¤æ˜“é‡ä½äº@(ç½® d 'lgua-n)ä½ï¼Œä»·æ ¼ä½äº@(ç½® d 'jgua-n)ä½ã€‚})

(å (é£é™© d)
    (å½“
     [(è¶…é‡è¶…ä»·? d) "âš ï¸ é£é™©æç¤ºï¼šè¶…é‡è¶…ä»·(å¤šæ–¹ä¹°å…¥)ã€‚"]
     [(å¤©é‡åœ°ä»·? d) "âœ… ä¹°å…¥ä¿¡å·ï¼šå¤©é‡åœ°ä»·(è¶…å¼ºä¹°å…¥)ï¼Œå¯ä»¥å…¥åœºã€‚"]
     [(å¤©ä»·åœ°é‡? d) "âš ï¸ é£é™©æç¤ºï¼šå¤©ä»·åœ°é‡ï¼Œéœ€å¯†åˆ‡å…³æ³¨ï¼Œå¦‚å·²è´­å…¥ï¼Œå»ºè®®å‡ä»“ã€‚"]
     [(é«˜ä»·ç¼©é‡? d) "ğŸ”» å–å‡ºä¿¡å·ï¼šé«˜ä»·ç¼©é‡(å–å‡ºä¿¡å·)ã€‚"]
     [(ä½ä»·èµ·é‡? d) "âœ… ä¹°å…¥ä¿¡å·ï¼šä½ä»·èµ·é‡(ä¸€èˆ¬ä¹°å…¥)ã€‚"]
     [(ä½ä»·ä½é‡? d) "ğŸ” è§‚æœ›å¸‚åœºï¼šä½ä»·ä½é‡(å¸‚åœºä½é¡), ä¸å»ºè®®æ“ä½œã€‚"]
     [å¤¬ "ç³»ç»Ÿæš‚æ— å»ºè®®ã€‚"]))

(å (é£é™©? d)
    (æˆˆ (è¶…é‡è¶…ä»·? d)
        (å¤©é‡åœ°ä»·? d)
        (å¤©ä»·åœ°é‡? d)
        (é«˜ä»·ç¼©é‡? d)
        (ä½ä»·èµ·é‡? d)))

(å (æ¦‚è§ˆ d)
    @~a{å½“æ—¥å‡ä»·æ˜¯@(ô¹” (ô¿°å¼” d 'avg-price))å…ƒï¼Œäº¤æ˜“é‡ä¸º@(ô¹“ (/ (å¥åŒ–ç±³ (ô¿°å¼” d 'volume)) 10000))ä¸‡æ‰‹ã€‚})

(å (é¢„è­¦ è‚¡ç  d)
    (å äº‘ (é£é™© d))
    (å è‚¡ (ô¹‰ è‚¡ç  è‡ªé€‰))
    (ô¸£ (å¹¶ (é£é™©? d) è‚¡)
        (ä»¤ ([t (~a (é˜´ è‚¡) (é˜³ è‚¡))]
             [m (~a (æ¦‚è§ˆ d) "\n" (é‡ä»·è§£æ d) "\n" äº‘ "\n" "https://www.yanying.wang/ggfsm/" è‚¡ç  "-3md.html" )])
            (bark-xr t m)
            (ntfy t m)))
    äº‘)

