#lang at-exp racket/base

(require ming ming/list ming/string ming/number net/uri-codec
         racket/format
         "gua-helper.rkt"
         "8gua.rkt"
         "64gua.rkt"
         "senders.rkt"
         "zixuan.rkt")
(provide å¤©ä»·åœ°é‡? å¤©é‡åœ°ä»·? é«˜ä»·ç¼©é‡? ä½ä»·èµ·é‡? ä½ä»·ä½é‡? è¶…é‡è¶…ä»·?
         get-days å¦è±¡è§£æ é‡ä»·è§£æ æ¦‚è§ˆ é£é™© é¢„è­¦)

;; (å (ä»Šæ—¥ä¹°å–ç‚¹ data)
;;     (å data0 (ô¾› data))
;;     (å d0 (ô·œ data))
;;     (å d1 (ô·› data))
;;     (å d2 (ô·š data))
;;     (å datan3 (d0 d1 d2))
;;     )

;; (å (æŒç»­è·ƒè¿? d0 d1 d2)
;;     (å n1
;;         (ô·‘ôº— (å…¥ (d) (ô¿°å¼” 'jgua-n d)) (ô¿´ d0 d1 d2)))
;;     (å n2
;;         (ô·‘ôº˜ (å…¥ (d) (ô¿°å¼” 'jgua-n d)) (ô¿´ d0 d1 d2)))
;;     (ä¸« (> (- n1 n2) 1)
;;         #t
;;         #f)
;;     )

;; (å (å½“æ—¥æ´»è·ƒ? d0 d1 d2)
;;     (if (> (ô¿°å¼” d0 'lgua-n) 4)
;;         #t
;;         #f))

;; (å (ä¹°å…¥? d0 d1 d2)
;;     (if (< (ô¿°å¼” d0 'jgua-n) 3)
;;         #t
;;         #f))

;; (å (å–å‡º? d0 d1 d2)
;;     (if (> (ô¿°å¼” d0 'jgua-n) 5)
;;         #t
;;         #f))

;; (å (ç”±ä½è·ƒé«˜ d))

;; (å (ç”±é«˜è·ƒä½ d))

(å (è¶…é‡è¶…ä»·? d)
    (å¹¶ (> (ô¿°å¼” d 'jgua-n) 5)
        (> (ô¿°å¼” d 'lgua-n) 5)))

(å (å¤©ä»·åœ°é‡? d)
    (å¹¶ (> (ô¿°å¼” d 'jgua-n) 5)
        (< (ô¿°å¼” d 'lgua-n) 2)))

(å (å¤©é‡åœ°ä»·? d)
    (å¹¶ (< (ô¿°å¼” d 'jgua-n) 2)
        (> (ô¿°å¼” d 'lgua-n) 5)))

(å (é«˜ä»·ç¼©é‡? d)
    (å¹¶ (> (ô¿°å¼” d 'jgua-n) 5)
        (å¹¶ (> (ô¿°å¼” d 'lgua-n) 2)
            (< (ô¿°å¼” d 'lgua-n) 5))))

(å (ä½ä»·èµ·é‡? d)
    (å¹¶ (< (ô¿°å¼” d 'jgua-n) 3)
        (å¹¶ (> (ô¿°å¼” d 'lgua-n) 5)
            (< (ô¿°å¼” d 'lgua-n) 8))))

(å (ä½ä»·ä½é‡? d)
    (å¹¶ (< (ô¿°å¼” d 'jgua-n) 2)
        (< (ô¿°å¼” d 'lgua-n) 2)))

(å (ä¹°å…¥ä¿¡å·? dn) ; è¿ç»­ä¸‰æ—¥ä½ä»·èµ·é‡
    (ô· ä½ä»·èµ·é‡? dn))

(å (å–å‡ºä¿¡å·? dn) ; è¿ç»­ä¸‰æ—¥é«˜ä»·ç¼©é‡
    (ô· é«˜ä»·ç¼©é‡? dn))

(å (è¶…ä¹°ä¿¡å·? d)
    (å¤©é‡åœ°ä»·? d))

(å (é£é™©ä¿¡å·? d)
    (å¤©ä»·åœ°é‡? d))

(å (get-days proced dn)
    (ô·‘  (lambda (d) (ô¿°å¼” d 'day))
        (ô¹ˆ proced dn)))

(å (å¦è±¡è§£æ å¤å¦)
    (ä»¤ ([ä¸Šå¦ (ä¹‹ä¸Šå•å¦ å¤å¦)]
         [ä¸‹å¦ (ä¹‹ä¸‹å•å¦ å¤å¦)])
        @~a{@|å¤å¦| @(åŒ–å¦ç¬¦/64 å¤å¦) @(åŒ–å¦æ•°/64 å¤å¦)ï¼ŒVolumesï¼š@|ä¸Šå¦| @(åŒ–å¦ç¬¦/8 ä¸Šå¦) @(åŒ–å¦æ•°/8 ä¸Šå¦)ï¼› Priceï¼š@|ä¸‹å¦| @(åŒ–å¦ç¬¦/8 ä¸‹å¦) @(åŒ–å¦æ•°/8 ä¸‹å¦)ã€‚}))

(å (é‡ä»·è§£æ d)
    (å (ç½® data key)
        (è‚– (ô¿°å¼” data key)
            [(5 6 7) "High"]
            [(3 4) "Medium"]
            [(0 1 2) "Low"]
            [å¤¬ #f]))
    @~a{Trading volumes is in @(ç½® d 'lgua-n) position, and price is in @(ç½® d 'jgua-n) position.})

(å (é£é™© d)
    (å½“
     [(è¶…é‡è¶…ä»·? d) "âš ï¸ RISK: Above average volume and price, market overheating."]
     [(å¤©é‡åœ°ä»·? d) "âœ… BUY-IN: High volume with low price, market activing."]
     [(å¤©ä»·åœ°é‡? d) "âš ï¸ RISK: High price with low volume, market declining."]
     ;; [(é«˜ä»·ç¼©é‡? d) "ğŸ”» å–å‡ºä¿¡å·ï¼šé«˜ä»·ç¼©é‡(å–å‡ºä¿¡å·)ã€‚"]
     ;; [(ä½ä»·èµ·é‡? d) "âœ… ä¹°å…¥ä¿¡å·ï¼šä½ä»·èµ·é‡(ä¸€èˆ¬ä¹°å…¥)ã€‚"]
     [(ä½ä»·ä½é‡? d) "ğŸ” On-HOLD: Low price and low volume, no chance to trade here."]
     [å¤¬ "No hint."]))

(å (é£é™©? d)
    (æˆˆ (è¶…é‡è¶…ä»·? d)
        (å¤©é‡åœ°ä»·? d)
        (å¤©ä»·åœ°é‡? d)
        ;; (é«˜ä»·ç¼©é‡? d)
        ;; (ä½ä»·èµ·é‡? d)
        ))

(å (æ¦‚è§ˆ d)
    @~a{the average price is @(ô¹” (ô¿°å¼” d 'avg-price))ï¿¥ï¼Œtrade volume is @(ô¹“ (/ (å¥åŒ–ç±³ (ô¿°å¼” d 'volume)) 1000))k lots.})

(å (é¢„è­¦ æ ‡ è‚¡ç  d)
    (å äº‘ (é£é™© d))
    (å è‚¡ (ô¹‰ è‚¡ç  è‡ªé€‰))
    (ô¸£ (å¹¶ (é£é™©? d) è‚¡)
        (ä»¤ ([t (~a æ ‡ (é˜´ è‚¡) (é˜³ è‚¡))]
             [m @~a{
                    å½“æ—¥å¦è±¡ï¼š@(å¦è±¡è§£æ (ô¿°å¼” d 'bgua))
                    å½“æ—¥æ¦‚è§ˆï¼š@(æ¦‚è§ˆ d)
                    é‡ä»·è§£æï¼š@(é‡ä»·è§£æ d)
                    @äº‘}])
            (bark-xr t m)
            (ntfy t m)))
    äº‘)

